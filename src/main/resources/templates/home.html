<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <title>카페웨더</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <link th:href="@{/css/aboutfont.css}" rel="stylesheet">
    <link th:href="@{/css/homefont.css}" rel="stylesheet">
    <!-- 폰트 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Batang:wght@400;700&display=swap" rel="stylesheet">
    <th:block th:replace="/fragments/head.html :: head"></th:block>

</head>

<body>
    
    <div th:replace="/fragments/navbar.html :: navbarfragment"></div>


    <!-- Carousel Start -->
    <div class="container-fluid p-0 wow fadeIn" data-wow-delay="0.1s">
        <div id="header-carousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img class="w-100" th:src="@{/img/header/003.png}" alt="Image">
                </div>
                <!-- <div class="carousel-item">
                    <img class="w-100" th:src="@{/img/aboutUs/aaaa.png}" alt="Image">
                </div> -->
            </div>
            <!-- <button class="carousel-control-prev" type="button" data-bs-target="#header-carousel"
                data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button> -->
            <!-- <button class="carousel-control-next" type="button" data-bs-target="#header-carousel"
                data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button> -->
        </div>
    </div>
    <!-- Carousel End -->


    <!-- 추천 Start -->
    <div class="container-xxl py-5">
        <div class="container">
            <div class="row g-5 align-items-center">
                <div class="col-lg-5 wow fadeIn" data-wow-delay="0.5s">
                    <img class="img-fluid" id="backimage" style="height: 400px; width: 400px;" />
                </div>
                <div class="col-lg-7 wow fadeIn" data-wow-delay="0.1s">
                    <h1 class="point">How's the weather today ?</h1>
                    
                        <font size="6em">
                            <p class="point">오늘의 날씨에 따라, <br>디저트와 음료를 추천 해드립니다.  <br></p>
                            <!-- <p><i class="fa fa-check text-primary me-3"></i>Clita duo justo magna dolore erat amet</p> -->
                        </font>    
                    
                    <div class="col-lg-6 wow fadeIn" data-wow-delay="0.5s">
                        <font size="4em">
                            <strong class="point">비가 오거나 햇살이 따사로운 날,  <br/>또는 눈 내리는 날 <br/> 어떤 음료나 디저트가 어울릴까요?
                                <br/>저희 Weather 가 추천 해드립니다 !</strong>
                            </strong>
                            <!-- <strong class="point">어떤 음료나 디저트가 어울릴까요?
                            <strong class="point">저희 Whether 가 추천드립니다.</strong> -->
                        </font>
                        <br/>
                        <br/>
                        <a class="btn btn-primary rounded-pill py-3 pt-3 mt-3 fontmalgun" id="recommendbtn" data-bs-toggle="modal" data-bs-target="#recommendModalForm">추천받기</a>
                        <a class="btn btn-primary rounded-pill py-3 pt-3 mt-3 fontmalgun" th:href="@{/about/home.do}">weather cafe란?</a>
                    </div>
                </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 추천 모달 start-->
    <div class="modal fade" id="recommendModalForm" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title fontmalgun">추천 메뉴</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="col-md-6 text-center" style="float: left; margin-top: 10%;">
                        <img class="img-fluid rounded-circle" id="recommenddrink" alt="140x140" style="width: 140px; height: 140px;">
                        <h4 class="fontmalgun" id="drinkname"></h4>
                        <p id="drinkcontent"></p>
                        <p>
                            <input type="hidden" id="drinkno" />
                            <a class="btn btn-primary rounded-pill" id="drinkdetailview" role="button">상세보기</a>
                            <button class="btn btn-primary rounded-pill" id="drinkcart">카트담기</button>
                        </p>
                    </div>
    
                    <div class="col-md-6 text-center" style="float: left; margin-top: 10%;">
                        <img class="img-circle" id="recommenddessert" alt="140x140" style="width: 140px; height: 140px;">
                        <h4 class="fontmalgun" id="dessertname"></h4>
                        <p id="dessertcontent"></p>
                        <p>
                            <input type="hidden" id="dessertno" />
                            <a class="btn btn-primary rounded-pill fontmalgun" id="dessertdetailview" role="button">상세보기</a>
                            <button class="btn btn-primary rounded-pill fontmalgun" id="dessertcart">카트담기</button>
                        </p>
                    </div>
                </div>
                <div class="modal-footer">
                    <div style="width: 100%; text-align: center;">
                        <input type="button" class="btn btn-primary rounded-pill py-3 fontmalgun" id="rerollrecommend" value="재추첨하기" />
                        <input type="button" class="btn btn-primary rounded-pill py-3 fontmalgun" id="cartallbtn" value="카트모두담기" />             
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--추천 모달 end-->
    <!-- 추천 End -->

    <!-- Product Start -->
    <div class="container-xxl py-5">
        <div class="container">
            <div class="row g-0 gx-5 align-items-end">
                <div class="col-lg-6">
                    <div class="section-header text-start mb-5 wow fadeInUp" data-wow-delay="0.1s" style="max-width: 500px;">
                        <h1 class="display-5 mb-3 fontmalgun">인기상품</h1>
                        <!-- <p>Tempor ut dolore lorem kasd vero ipsum sit eirmod sit. Ipsum diam justo sed rebum vero dolor duo.</p> -->
                    </div>
                </div>
                <div class="col-lg-6 text-start text-lg-end wow slideInRight" data-wow-delay="0.1s">
                    <ul class="nav nav-pills d-inline-flex justify-content-end mb-5">
                        <li class="nav-item me-2">
                            <a class="btn btn-outline-primary border-2 active fontmalgun" data-bs-toggle="pill" href="#tab-1">음료</a>
                        </li>
                        <li class="nav-item me-2">
                            <a class="btn btn-outline-primary border-2 fontmalgun" data-bs-toggle="pill" href="#tab-2">디저트</a>
                        </li>
                        <li class="nav-item me-0">
                            <a class="btn btn-outline-primary border-2 fontmalgun" data-bs-toggle="pill" href="#tab-3">상품</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="tab-content">
                <div id="tab-1" class="tab-pane fade show p-0 active">
                    <div class="row g-4">
                        <div class="col-xl-3 col-lg-4 col-md-6 wow fadeInUp" data-wow-delay="0.1s" th:each="tmp, idx : ${coffeelist}">
                            <div class="product-item border">
                                <div class="position-relative bg-light overflow-hidden">
                                    <a th:href="@{/product/productone.do(no=${tmp.no})}">
                                        <img class="img-fluid w-100 border" th:src="@{${tmp.image} }" style="height: 350px;" alt="">
                                    </a>
                                    <div class="bg-secondary rounded text-white position-absolute start-0 top-0 m-4 py-1 px-3">HOT</div>
                                </div>
                                <div class="text-center p-4">
                                    <span class="d-block h5 mb-2 fontmalgun" th:text="${tmp.name}"></span>
                                    <span class="text-primary me-1 fontmalgun" name="p_price" th:text="${tmp.price + '원'}"></span>
                                    <input type="hidden" th:value="${tmp.no}" name="drinklistno">
                                    <input type="hidden" value="1" name="quantity">
                                    <!-- <span class="text-body text-decoration-line-through">$29.00</span> -->
                                </div>
                                <div class="d-flex border-top">
                                    <small class="w-50 text-center border-end py-2">
                                        <a class="text-body" th:href="@{/product/productone.do(no=${tmp.no})}"><i class="fa fa-eye text-primary me-2"></i>상세보기</a>
                                    </small>
                                    <small class="w-50 text-center py-2">
                                        <i class="fa fa-shopping-bag text-primary me-2"></i>
                                        <input class="text-body" type="submit" value="장바구니담기" name="drinklistcart" style="background-color:transparent;  border:0px transparent solid;">
                                    </small>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 text-center wow fadeInUp" data-wow-delay="0.1s">
                            <a class="btn btn-primary rounded-pill py-3 px-5 fontmalgun" th:href="@{/product/list.do?category=drink}">음료 더보기</a>
                        </div>
                    </div>
                </div>
                <div id="tab-2" class="tab-pane fade show p-0">
                    <div class="row g-4">
                        <div class="col-xl-3 col-lg-4 col-md-6" th:each="tmp, idx : ${dessertlist}">
                            <div class="product-item">
                                <div class="position-relative bg-light overflow-hidden">
                                    <a th:href="@{/product/productone.do(no=${tmp.no})}">
                                        <img class="img-fluid w-100 border" th:src="@{${tmp.image} }" style="height: 350px;" alt="">
                                    </a>
                                    <div class="bg-secondary rounded text-white position-absolute start-0 top-0 m-4 py-1 px-3">HIT</div>
                                </div>
                                <div class="text-center p-4">
                                    <span class="d-block h5 mb-2 fontmalgun" th:text="${tmp.name}"></span>
                                    <span class="text-primary me-1 fontmalgun" th:text="${tmp.price + '원'}"></span>
                                    <input type="hidden" th:value="${tmp.no}" name="dessertlistno">
                                    <input type="hidden" value="1" name="quantity">
                                    <!-- <span class="text-body text-decoration-line-through">$29.00</span> -->
                                </div>
                                <div class="d-flex border-top">
                                    <small class="w-50 text-center border-end py-2">
                                        <a class="text-body" th:href="@{/product/productone.do(no=${tmp.no})}"><i class="fa fa-eye text-primary me-2"></i>상세보기</a>
                                    </small>
                                    <small class="w-50 text-center py-2">
                                        <i class="fa fa-shopping-bag text-primary me-2"></i>
                                        <input class="text-body" type="submit" value="장바구니담기" name="dessertlistcart" style="background-color:transparent;  border:0px transparent solid;">
                                    </small>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 text-center">
                            <a class="btn btn-primary rounded-pill py-3 px-5" th:href="@{/product/list.do?category=dessert}">디저트 더보기</a>
                        </div>
                    </div>
                </div>
                <div id="tab-3" class="tab-pane fade show p-0">
                    <div class="row g-4">
                        <div class="col-xl-3 col-lg-4 col-md-6" th:each="tmp, idx : ${itemlist}">
                            <div class="product-item">
                                <div class="position-relative bg-light overflow-hidden">
                                    <a th:href="@{/product/productone.do(no=${tmp.no})}">
                                        <img class="img-fluid w-100 border" th:src="@{${tmp.image} }" style="height: 350px;" alt="">
                                    </a>
                                    <div class="bg-secondary rounded text-white position-absolute start-0 top-0 m-4 py-1 px-3">HOT</div>
                                </div>
                                <div class="text-center p-4">
                                    <span class="d-block h5 mb-2 fontmalgun" th:text="${tmp.name}"></span>
                                    <span class="text-primary me-1 fontmalgun" th:text="${tmp.price + '원'}"></span>
                                    <input type="hidden" th:value="${tmp.no}" name="goodslistno">
                                    <input type="hidden" value="1" name="quantity">
                                    <!-- <span class="text-body text-decoration-line-through">$29.00</span> -->
                                </div>
                                <div class="d-flex border-top">
                                    <small class="w-50 text-center border-end py-2">
                                        <a class="text-body" th:href="@{/product/productone.do(no=${tmp.no})}"><i class="fa fa-eye text-primary me-2"></i>상세보기</a>
                                    </small>
                                    <small class="w-50 text-center py-2">
                                        <i class="fa fa-shopping-bag text-primary me-2"></i>
                                        <input class="text-body" type="submit" value="장바구니담기" name="goodslistcart" style="background-color:transparent;  border:0px transparent solid;">
                                    </small>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 text-center">
                            <a class="btn btn-primary rounded-pill py-3 px-5" th:href="@{/product/list.do?category=goods}">상품 더보기</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Product End -->

    <!-- review Start -->
    <div class="container-fluid bg-light bg-icon py-6 mb-5">
        <div class="container">
            <div class="section-header text-center mx-auto mb-5 wow fadeInUp" data-wow-delay="0.1s" style="max-width: 500px;">
                <h1 class="display-5 mb-3 fontmalgun">베스트 리뷰</h1>
            </div>
            <div class="owl-carousel testimonial-carousel wow fadeInUp" data-wow-delay="0.1s" id="bestreview" >

                <div class="testimonial-item position-relative bg-white p-5 mt-4" th:each="tmp, idx : ${reviewlist}"  >
                    <i class="fa fa-quote-left fa-3x text-primary position-absolute top-0 start-0 mt-n4 ms-5"></i>

                    <pre class="mb-4 bestreview" th:text="${tmp.CONTENT}"></pre>

                    <div class="d-flex align-items-center">
                        <img class="flex-shrink-0 rounded-circle border" th:src="@{${tmp.profileurl} }" alt="">

                        <div class="ms-3">

                            <h5 class="mb-1 fontmalgun bestreview1" th:text="${tmp.TITLE}" style="margin-top: 30px;"></h5>
                            <span style="vertical-align: middle;">
                                <img th:src="@{/img/Review/likeEmpty.png}" style="width: 20px; height: 20px; float: left;">
                                <p style="float: left; margin-left: 5px; font-weight: 400;" th:text="${tmp.CNT}"></p>
                            </span>

                        </div>
                    </div>
                    <strong>
                        <font size="1em">
                            <a th:href="@{/product/productone.do(no=${tmp.PRODUCTNO})}"><p style="color:  rgb(44, 102, 144);" th:text="${tmp.NAME}"></p></a>
                        </font>
                    </strong>
                </div>
                
                
            </div><button class="carousel-control-prev" type="button" data-bs-target="#bestreview"
                data-bs-slide="prev">
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#bestreview"
                    data-bs-slide="next">
                </button>
        </div>
    </div>
    <!-- review End -->

    <div th:replace="/fragments/footer.html :: footerfragment"></div>

    <script>

        var backimage               = document.getElementById('backimage');
        const recommendbtn          = document.getElementById('recommendbtn');
        const recommendModalForm    = document.getElementById('recommendModalForm');
        const recommenddrink       = document.getElementById('recommenddrink');
        const recommenddessert      = document.getElementById('recommenddessert');


        if(document.readyState == "loading"){

            backimage.src = "[[@{/img/300w.gif}]]";
            var url = "[[@{/api/select.json}]]";

            axios.get(url).then(function(response){
                console.log(response);
                backimage.src = response.data.backurl;
                sessionStorage.setItem("category", response.data.result);
            });
        }

        // window.addEventListener('load', function(){
        //     backimage.src = "[[@{/img/300w.gif}]]";
        //     var url = "[[@{/api/select.json}]]";

        //     axios.get(url).then(function(response){
        //         console.log(response);
        //         backimage.src = response.data.backurl;
        //         sessionStorage.setItem("category", response.data.result);
        //     });

        // });

        recommendbtn.addEventListener('click', function(){

            recommenddrink.src      = "[[@{/img/300w.gif}]]";
            recommenddessert.src    = "[[@{/img/300w.gif}]]";
            
            var url = `[[@{/rest/recommend/random.json?category=}]]` + sessionStorage.getItem("category"); 

            axios.get(url).then(function(response){
                console.log(response);
                recommenddrink.src      = response.data.drink.productimageurl;
                recommenddessert.src    = response.data.dessert.productimageurl;
                document.getElementById('drinkname').textContent        = response.data.drink.productname; 
                document.getElementById('dessertname').textContent      = response.data.dessert.productname; 
                document.getElementById('drinkcontent').textContent     = response.data.drink.content; 
                document.getElementById('dessertcontent').textContent   = response.data.dessert.content;
                document.getElementById('drinkno').value    = response.data.drink.productno;   
                document.getElementById('dessertno').value    = response.data.dessert.productno;   
            });

        });
        
        recommendModalForm.addEventListener('hidden.bs.modal', function(){
            recommenddrink.src = "";
            recommenddessert.src = "";
            document.getElementById('drinkname').textContent = ""; 
            document.getElementById('dessertname').textContent = ""; 
            document.getElementById('drinkcontent').textContent = ""; 
            document.getElementById('dessertcontent').textContent = "";
        });

        document.getElementById('drinkdetailview').addEventListener('click', function(){
            window.location.href = `[[@{/product/productone.do(no=)}]]` + document.getElementById('drinkno').value; 
        });

        document.getElementById('dessertdetailview').addEventListener('click', function(){
            window.location.href = `[[@{/product/productone.do(no=)}]]` + document.getElementById('dessertno').value; 
        });

        document.getElementById('rerollrecommend').addEventListener('click', function(){
            recommenddrink.src      = "[[@{/img/300w.gif}]]";
            recommenddessert.src    = "[[@{/img/300w.gif}]]";
            document.getElementById('drinkname').textContent        = ""; 
            document.getElementById('dessertname').textContent      = ""; 
            document.getElementById('drinkcontent').textContent     = ""; 
            document.getElementById('dessertcontent').textContent   = "";

            var url = `[[@{/rest/recommend/random.json?category=}]]` + sessionStorage.getItem("category");; 

            axios.get(url).then(function(response){
                console.log(response);
                recommenddrink.src      = response.data.drink.productimageurl;
                recommenddessert.src    = response.data.dessert.productimageurl;
                document.getElementById('drinkname').textContent        = response.data.drink.productname; 
                document.getElementById('dessertname').textContent      = response.data.dessert.productname; 
                document.getElementById('drinkcontent').textContent     = response.data.drink.content; 
                document.getElementById('dessertcontent').textContent   = response.data.dessert.content;
                document.getElementById('drinkno').value    = response.data.drink.productno;   
                document.getElementById('dessertno').value    = response.data.dessert.productno;   
            });
        });

        document.getElementById('drinkcart').addEventListener('click', function(){
            
            var url     = `[[@{/rest/recommend/insert.json}]]`;
            var body    = {
                productno : document.getElementById('drinkno').value
            };            

            axios.post(url, body).then(function(response){
                console.log(response);
                if(response.data.status == 200){
                    alert('성공적으로 카트에 담겼습니다.');
                    const url1 = `[[@{/rest/cart/count.json}]]`;

                    axios.get(url1).then(function(response){
                        console.log(response);
                        document.getElementById('cartcount').innerText  = response.data;
                        document.getElementById('cartcount1').innerText = response.data;
                    });
                }
            });
        });

        document.getElementById('dessertcart').addEventListener('click', function(){
            
            var url     = `[[@{/rest/recommend/insert.json}]]`;
            var body    = {
                productno : document.getElementById('dessertno').value
            };
            
            axios.post(url, body).then(function(response){
                console.log(response);
                if(response.data.status == 200){
                    alert('성공적으로 카트에 담겼습니다.');

                    const url1 = `[[@{/rest/cart/count.json}]]`;

                    axios.get(url1).then(function(response){
                        console.log(response);
                        document.getElementById('cartcount').innerText = response.data;
                        document.getElementById('cartcount1').innerText = response.data;
                    });
                }
            });
        });

        document.getElementById('cartallbtn').addEventListener('click', function(){
            var url     = `[[@{/rest/recommend/insertall.json}]]`;
            var body    = {
                productno : document.getElementById('dessertno').value,
                productno1 : document.getElementById('drinkno').value
            };
            
            console.log(body);

            axios.post(url, body).then(function(response){
                console.log(response);
                if(response.data.status == 200){
                    alert('성공적으로 카트에 담겼습니다.');

                    const url1 = `[[@{/rest/cart/count.json}]]`;

                    axios.get(url1).then(function(response){
                        console.log(response);
                        document.getElementById('cartcount').innerText = response.data;
                        document.getElementById('cartcount1').innerText = response.data;
                    });
                }
            });
        });

        // 가격 콤마찍기
        var price = document.getElementsByName("p_price");
        // console.log(price);
        var pprice = document.getElementsByClassName("text-primary me-1");
        for(i=0; i<price.length; i++){
            price2 = price[i].innerHTML.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g, ","); 
            // console.log(price2);
            pprice[i].innerHTML=price2
        }


        var drinkcartbtns   = document.getElementsByName('drinklistcart');
        var drinknos        = document.getElementsByName('drinklistno');
        var dessertcartbtns = document.getElementsByName('dessertlistcart');
        var dessertnos      = document.getElementsByName('dessertlistno');
        var goodscartbtns   = document.getElementsByName('goodslistcart');
        var goodsnos        = document.getElementsByName('goodslistno');

        for(let i=0; i<drinkcartbtns.length; i++){
            drinkcartbtns[i].addEventListener('click', function(){
                var url     = `[[@{/rest/recommend/insert.json}]]`;
                var body    = {
                    productno : drinknos[i].value
                };
                
                axios.post(url, body).then(function(response){
                    console.log(response);
                    if(response.data.status == 200){
                        alert('성공적으로 카트에 담겼습니다.');
    
                        const url1 = `[[@{/rest/cart/count.json}]]`;
    
                        axios.get(url1).then(function(response){
                            console.log(response);
                            document.getElementById('cartcount').innerText = response.data;
                            document.getElementById('cartcount1').innerText = response.data;
                        });
                    }
                });
            });
        }

        for(let i=0; i<dessertcartbtns.length; i++){
            dessertcartbtns[i].addEventListener('click', function(){
                var url     = `[[@{/rest/recommend/insert.json}]]`;
                var body    = {
                    productno : dessertnos[i].value
                };
                
                axios.post(url, body).then(function(response){
                    console.log(response);
                    if(response.data.status == 200){
                        alert('성공적으로 카트에 담겼습니다.');
    
                        const url1 = `[[@{/rest/cart/count.json}]]`;
    
                        axios.get(url1).then(function(response){
                            console.log(response);
                            document.getElementById('cartcount').innerText = response.data;
                            document.getElementById('cartcount1').innerText = response.data;
                        });
                    }
                });
            });
        }

        for(let i=0; i<goodscartbtns.length; i++){
            goodscartbtns[i].addEventListener('click', function(){
                var url     = `[[@{/rest/recommend/insert.json}]]`;
                var body    = {
                    productno : goodsnos[i].value
                };
                
                axios.post(url, body).then(function(response){
                    console.log(response);
                    if(response.data.status == 200){
                        alert('성공적으로 카트에 담겼습니다.');
    
                        const url1 = `[[@{/rest/cart/count.json}]]`;
    
                        axios.get(url1).then(function(response){
                            console.log(response);
                            document.getElementById('cartcount').innerText = response.data;
                            document.getElementById('cartcount1').innerText = response.data;
                        });
                    }
                });
            });
        }


    </script>
</body>

</html>